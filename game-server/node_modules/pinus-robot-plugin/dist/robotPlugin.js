"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const pinus_robot_1 = require("pinus-robot");
const path = require("path");
/**
 * 实现机器人Master服务器插件
 */
class RobotPlugin {
    constructor(conf) {
        this.conf = conf;
        this.name = 'RobotPlugin';
    }
    /**
     * 当所有服务器启动完毕后调用
     * @param app
     */
    afterStartAll(app) {
        let robot = new pinus_robot_1.Robot(this.conf);
        let mode = 'master';
        let scriptFile = path.normalize(this.conf.scriptFile);
        if (path.sep === '\\') {
            scriptFile = scriptFile.replace(/\\/g, '\\\\');
        }
        // 启动机器人总管
        robot.runMaster(`"${__dirname}/robotAgent.js" --host=${this.conf.master.host} --port=${this.conf.master.port} --interval=${this.conf.master.interval} --scriptFile="${scriptFile}"`);
    }
}
exports.RobotPlugin = RobotPlugin;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm9ib3RQbHVnaW4uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvcm9ib3RQbHVnaW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSw2Q0FBOEM7QUFFOUMsNkJBQThCO0FBRTlCOztHQUVHO0FBQ0g7SUFHSSxZQUFvQixJQUFjO1FBQWQsU0FBSSxHQUFKLElBQUksQ0FBVTtRQUZsQyxTQUFJLEdBQUcsYUFBYSxDQUFDO0lBSXJCLENBQUM7SUFFRDs7O09BR0c7SUFDSCxhQUFhLENBQUMsR0FBZ0I7UUFDMUIsSUFBSSxLQUFLLEdBQUcsSUFBSSxtQkFBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNqQyxJQUFJLElBQUksR0FBRyxRQUFRLENBQUM7UUFDcEIsSUFBSSxVQUFVLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3RELElBQUcsSUFBSSxDQUFDLEdBQUcsS0FBSyxJQUFJLEVBQUU7WUFDbEIsVUFBVSxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFHLE1BQU0sQ0FBQyxDQUFDO1NBQ25EO1FBQ0QsVUFBVTtRQUNWLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxTQUFTLDBCQUEwQixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLFdBQVcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxlQUFlLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsa0JBQWtCLFVBQVUsR0FBRyxDQUFDLENBQUM7SUFDekwsQ0FBQztDQUNKO0FBckJELGtDQXFCQyJ9