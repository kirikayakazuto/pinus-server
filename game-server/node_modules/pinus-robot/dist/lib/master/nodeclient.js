"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const __ = require("underscore");
// NodeClient is a server/machine/instance running a agent socket
class NodeClient {
    constructor(nodeId, socket, server) {
        this.nodeId = nodeId;
        this.socket = socket;
        this.iport = socket.handshake.address;
        this.id = socket.id;
        this.log_server = server;
        // Join 'nodes' room
        socket.join('nodes');
        socket.on('disconnect', () => {
            // Notify all WebClients upon disconnect
            __(this.log_server.web_clients).each((web_client, client_id) => {
                web_client.remove_node(this);
            });
            socket.leave('nodes');
        });
    }
}
exports.NodeClient = NodeClient;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZWNsaWVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9tYXN0ZXIvbm9kZWNsaWVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLGlDQUFpQztBQUdqQyxpRUFBaUU7QUFDakU7SUFNRSxZQUFZLE1BQWMsRUFBRSxNQUF1QixFQUFFLE1BQWM7UUFDakUsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQztRQUN0QyxJQUFJLENBQUMsRUFBRSxHQUFHLE1BQU0sQ0FBQyxFQUFFLENBQUM7UUFDcEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUM7UUFFekIsb0JBQW9CO1FBQ3BCLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFckIsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFO1lBQzNCLHdDQUF3QztZQUN4QyxFQUFFLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxVQUFlLEVBQUUsU0FBaUIsRUFBRSxFQUFFO2dCQUMxRSxVQUFVLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQy9CLENBQUMsQ0FBQyxDQUFDO1lBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN4QixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRjtBQXhCRCxnQ0F3QkMifQ==